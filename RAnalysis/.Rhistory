Day1_PropLive_RxnNorm <- data_filt %>% # data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502) %>% # filter for desired date of rhte experiment
dplyr::select(c('Date','pCO2_exposure','pCO2_history','SYBR_PI_prop_alive_ADJ')) %>%
na.omit() %>%
group_by(pCO2_exposure, pCO2_history) %>% # group by columns for treatment
dplyr::summarise( # summarise to aquire the mean and SE for plotting
PercLive_mean = mean(SYBR_PI_prop_alive_ADJ), # mean
PercLive_sd = sd(SYBR_PI_prop_alive_ADJ), # sd
n = n(), # count
PercLive_se = PercLive_sd / sqrt(n)) %>% # SE
# plot it
ggplot(aes(x=pCO2_exposure, y=PercLive_mean, group=pCO2_history)) +
geom_line(aes(group = factor(pCO2_history), linetype = pCO2_history), size = 0.5, position=position_dodge(.4)) +  # connect a line between variables
scale_linetype_manual(values=c("solid", "dashed", "dotted")) +
geom_point(aes(shape=pCO2_history, fill=pCO2_history), size = 4,position=position_dodge(.4)) +
scale_shape_manual(values=c(16, 17, 4)) + # filled circle, filled triangle, and X
scale_fill_manual(values=c('white','white', 'black')) + # fill cicle white, triangle white, and jsut black for the X
geom_errorbar(aes(ymin=(PercLive_mean)-(PercLive_se),
ymax=(PercLive_mean)+(PercLive_se)),
width=.2,position=position_dodge(.4)) +
# geom_jitter() +
theme_classic() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Percent alive cells - 24 hours") +
labs(y= "Percent alive cells (%)", x = "pCO2 Exposure") # +
# facet_wrap(~pCO2_history)
Day1_PropLive_RxnNorm
Day1_MitoROS_RxnNorm <- data_filt %>% # data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502) %>% # filter for desired date of rhte experiment
dplyr::mutate(MitoSoxGreen_Mean_FL1 = as.numeric(MitoSoxGreen_Mean_FL1)) %>%
na.omit() %>%  # omitts sample ID 64 that did not have sufficient hemolymph for this assay
#dplyr::select(c('pCO2_exposure', 'pCO2_history','SYBR_PI_count_alive')) %>%  # select desired columns
group_by(pCO2_exposure, pCO2_history) %>% # group by columns for treatment
dplyr::summarise( # summarise to aquire the mean and SE for plotting
MitROS_mean = mean(MitoSoxGreen_Mean_FL1), # mean
MitROS_sd = sd(MitoSoxGreen_Mean_FL1), # sd
n = n(), # count
MitROS_se = MitROS_sd / sqrt(n)) %>% # SE
# plot it
ggplot(aes(x=pCO2_exposure, y=MitROS_mean, group=pCO2_history)) +
geom_line(aes(group = factor(pCO2_history), linetype = pCO2_history), size = 0.5, position=position_dodge(.4)) +  # connect a line between variables
scale_linetype_manual(values=c("solid", "dashed", "dotted")) +
geom_point(aes(shape=pCO2_history, fill=pCO2_history), size = 4,position=position_dodge(.4)) +
scale_shape_manual(values=c(16, 17, 4)) + # filled circle, filled triangle, and X
scale_fill_manual(values=c('white','white', 'black')) + # fill cicle white, triangle white, and jsut black for the X
geom_errorbar(aes(ymin=(MitROS_mean)-(MitROS_se),
ymax=(MitROS_mean)+(MitROS_se)),
width=0,position=position_dodge(.4)) + # width dtermines the length of the end ticks
# geom_jitter() +
theme_classic() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Mitochondrial ROS - 24 hours") +
labs(y= "A.U.", x = "pCO2 Exposure") #+
Day14_MitoROS_RxnNorm <- data_filt %>% # data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230516) %>% # filter for desired date of rhte experiment
dplyr::mutate(MitoSoxGreen_Mean_FL1 = as.numeric(sub(",", "", MitoSoxGreen_Mean_FL1))) %>% # the % sign is included making this a character, omit the percent and make numeric!
dplyr::select(c('Date','pCO2_exposure','pCO2_history','MitoSoxGreen_Mean_FL1')) %>%
na.omit() %>%
group_by(pCO2_exposure, pCO2_history) %>% # group by columns for treatment
dplyr::summarise( # summarise to aquire the mean and SE for plotting
MitROS_mean = mean(MitoSoxGreen_Mean_FL1), # mean
MitROS_sd = sd(MitoSoxGreen_Mean_FL1), # sd
n = n(), # count
MitROS_se = MitROS_sd / sqrt(n)) %>% # SE
# plot it
ggplot(aes(x=pCO2_exposure, y=MitROS_mean, group=pCO2_history)) +
geom_line(aes(group = factor(pCO2_history), linetype = pCO2_history), size = 0.5, position=position_dodge(.4)) +  # connect a line between variables
scale_linetype_manual(values=c("solid", "dashed", "dotted")) +
geom_point(aes(shape=pCO2_history, fill=pCO2_history), size = 4,position=position_dodge(.4)) +
scale_shape_manual(values=c(16, 17, 4)) + # filled circle, filled triangle, and X
scale_fill_manual(values=c('white','white', 'black')) + # fill cicle white, triangle white, and jsut black for the X
geom_errorbar(aes(ymin=(MitROS_mean)-(MitROS_se),
ymax=(MitROS_mean)+(MitROS_se)),
width=0,position=position_dodge(.4)) + # width dtermines the length of the end ticks
# geom_jitter() +
theme_classic() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Mitochondrial ROS - 14 days") +
labs(y= "A.U.", x = "pCO2 Exposure")# +
#facet_wrap(~pCO2_history)
Day14_MitoROS_RxnNorm
Day1_MitoROS_RxnNorm <- data_filt %>% # data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502) %>% # filter for desired date of rhte experiment
dplyr::mutate(MitoSoxGreen_Mean_FL1 = as.numeric(MitoSoxGreen_Mean_FL1)) %>%
dplyr::select(c('Date','pCO2_exposure','pCO2_history','MitoSoxGreen_Mean_FL1')) %>%
na.omit() %>%
group_by(pCO2_exposure, pCO2_history) %>% # group by columns for treatment
dplyr::summarise( # summarise to aquire the mean and SE for plotting
MitROS_mean = mean(MitoSoxGreen_Mean_FL1), # mean
MitROS_sd = sd(MitoSoxGreen_Mean_FL1), # sd
n = n(), # count
MitROS_se = MitROS_sd / sqrt(n)) %>% # SE
# plot it
ggplot(aes(x=pCO2_exposure, y=MitROS_mean, group=pCO2_history)) +
geom_line(aes(group = factor(pCO2_history), linetype = pCO2_history), size = 0.5, position=position_dodge(.4)) +  # connect a line between variables
scale_linetype_manual(values=c("solid", "dashed", "dotted")) +
geom_point(aes(shape=pCO2_history, fill=pCO2_history), size = 4,position=position_dodge(.4)) +
scale_shape_manual(values=c(16, 17, 4)) + # filled circle, filled triangle, and X
scale_fill_manual(values=c('white','white', 'black')) + # fill cicle white, triangle white, and jsut black for the X
geom_errorbar(aes(ymin=(MitROS_mean)-(MitROS_se),
ymax=(MitROS_mean)+(MitROS_se)),
width=0,position=position_dodge(.4)) + # width dtermines the length of the end ticks
# geom_jitter() +
theme_classic() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Mitochondrial ROS - 24 hours") +
labs(y= "A.U.", x = "pCO2 Exposure") #+
#facet_wrap(~pCO2_history)
Day1_MitoROS_RxnNorm
ggarrange(Day1_MitoROS_RxnNorm, Day14_MitoROS_RxnNorm, nrow=2)
Day14_MitoMemPot_RxnNorm <- data_filt %>% # data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230516) %>% # filter for desired date of rhte experiment
dplyr::select(c('Date','pCO2_exposure','pCO2_history','JC10_FL2_FL1_Ratio')) %>%
na.omit() %>%  # omitts sample ID 64 that did not have sufficient hemolymph for this assay
#dplyr::select(c('pCO2_exposure', 'pCO2_history','SYBR_PI_count_alive')) %>%  # select desired columns
group_by(pCO2_exposure, pCO2_history) %>% # group by columns for treatment
dplyr::summarise( # summarise to aquire the mean and SE for plotting
JC10_mean = mean(JC10_FL2_FL1_Ratio), # mean
JC10_sd = sd(JC10_FL2_FL1_Ratio), # sd
n = n(), # count
JC10_se = JC10_sd / sqrt(n)) %>% # SE
# plot it
ggplot(aes(x=pCO2_exposure, y=JC10_mean, group=pCO2_history)) +
geom_line(aes(group = factor(pCO2_history), linetype = pCO2_history), size = 0.5, position=position_dodge(.4)) +  # connect a line between variables
scale_linetype_manual(values=c("solid", "dashed", "dotted")) +
geom_point(aes(shape=pCO2_history, fill=pCO2_history), size = 4,position=position_dodge(.4)) +
scale_shape_manual(values=c(16, 17, 4)) + # filled circle, filled triangle, and X
scale_fill_manual(values=c('white','white', 'black')) + # fill cicle white, triangle white, and jsut black for the X
geom_errorbar(aes(ymin=(JC10_mean)-(JC10_se),
ymax=(JC10_mean)+(JC10_se)),
width=.2,position=position_dodge(.4)) +
# geom_jitter() +
theme_classic() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Mitochondrial membrane potential - 14 days") +
labs(y= "A.U.", x = "pCO2 Exposure") # +
#facet_wrap(~pCO2_history)
Day14_MitoMemPot_RxnNorm
Day1_MitoMemPot_RxnNorm <- data_filt %>% # data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502) %>% # filter for desired date of rhte experiment
dplyr::select(c('Date','pCO2_exposure','pCO2_history','JC10_FL2_FL1_Ratio')) %>%
na.omit() %>%  # omitts sample ID 64 that did not have sufficient hemolymph for this assay
#dplyr::select(c('pCO2_exposure', 'pCO2_history','SYBR_PI_count_alive')) %>%  # select desired columns
group_by(pCO2_exposure, pCO2_history) %>% # group by columns for treatment
dplyr::summarise( # summarise to aquire the mean and SE for plotting
JC10_mean = mean(JC10_FL2_FL1_Ratio), # mean
JC10_sd = sd(JC10_FL2_FL1_Ratio), # sd
n = n(), # count
JC10_se = JC10_sd / sqrt(n)) %>% # SE
# plot it
ggplot(aes(x=pCO2_exposure, y=JC10_mean, group=pCO2_history)) +
geom_line(aes(group = factor(pCO2_history), linetype = pCO2_history), size = 0.5, position=position_dodge(.4)) +  # connect a line between variables
scale_linetype_manual(values=c("solid", "dashed", "dotted")) +
geom_point(aes(shape=pCO2_history, fill=pCO2_history), size = 4,position=position_dodge(.4)) +
scale_shape_manual(values=c(16, 17, 4)) + # filled circle, filled triangle, and X
scale_fill_manual(values=c('white','white', 'black')) + # fill cicle white, triangle white, and jsut black for the X
geom_errorbar(aes(ymin=(JC10_mean)-(JC10_se),
ymax=(JC10_mean)+(JC10_se)),
width=.2,position=position_dodge(.4)) +
# geom_jitter() +
theme_classic() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Mitochondrial membrane potential - 24 hours") +
labs(y= "A.U.", x = "pCO2 Exposure")# +
#facet_wrap(~pCO2_history)
Day1_MitoMemPot_RxnNorm
ggarrange(Day1_MitoMemPot_RxnNorm, Day14_MitoMemPot_RxnNorm, nrow= 2)
# for loop d
Dates  <- as.data.frame(list(unique(paste(data_filt$Date))))
# for loop i
pCO2history_treatments  <- as.data.frame(list(unique(paste(data_filt$pCO2_history))))
# for loop m
FlowCy_probes           <- as.data.frame(list(c('SYBR_PI_prop_alive_ADJ',
'SYBR_PI_prop_dead_ADJ',
'MitoSoxGreen_Mean_FL1',
'JC10_FL2_FL1_Ratio')))
# prepare data for analysis
data2 <- data_filt %>%
dplyr::select(c("Date","pCO2_history","pCO2_exposure",
"SYBR_PI_prop_alive_ADJ","SYBR_PI_prop_dead_ADJ",
"MitoSoxGreen_Mean_FL1", "JC10_FL2_FL1_Ratio"))
# Call the cumulative dataframe that we will write to in the for loop below
df_total              <- data.frame() # start dataframe
stats.table           <- data.frame(matrix(nrow = 1, ncol = 10)) # create dataframe to save cumunalitively during for loop
colnames(stats.table) <- c('Date',
'pCO2_history',
'FlowCyProbe',
'Test',
'Shapiro',
'Levenes',
'DF',
'Fvalue',
'chisquared',
'Pvalue') # names for comuns in the for loop
for (d in 1:nrow(Dates)) {
data_by_date <- data2 %>%
dplyr::filter(Date %in% Dates[d,1])
for (i in 1:nrow(pCO2history_treatments)) {
# filter the dataset
data_by_history <- data_by_date %>%
dplyr::filter(pCO2_history %in% pCO2history_treatments[i,1])
#dplyr::filter(pCO2_exposure %in% gsub('.* ', '', treatments[i,1]))
for (m in 1:nrow(FlowCy_probes)) {
# if loop for probe type-speicif testing based on the naure of the data..
if (substr(FlowCy_probes[m,],1,4) == 'SYBR') { # if proportion data (0-1) we want to run beta regression models
colNum   <- which( colnames(data_by_history)==FlowCy_probes[m,])
data_by_history[,colNum] = as.numeric(data_by_history[,colNum])
modBetaReg     <- betareg(data_by_history[,colNum]~pCO2_exposure, data = data_by_history) # beta reg model suitable for prop data
modSUMMARY     <- joint_tests(modBetaReg) # use 'emmeans' pavkage for an anova-like table
modSUMMARYDF   <- signif(modSUMMARY[["df1"]][1], 2) # cal p value for anova table - 2 sig figs
modSUMMARYFval <- signif(modSUMMARY[["F.ratio"]][1], 4) # cal p value for anova table - 2 sig figs
modSUMMARYchi  <- NA
modSUMMARYPval <- signif(modSUMMARY[["p.value"]][1], 4) # cal p value for anova table - 2 sig figs
testRun        <- "Beta regression model"
shapTEST       <- 'NA' # proportion data between 0-1 is non parametric
levTEST        <- as.data.frame('NA','NA') # proportion data between 0-1 is non parametric, need to make table for if/else below
} else { # for the continuous data run ANOVA or Kruskal Wallis for norm/non-param. models
colNum   <- which( colnames(data_by_history)==FlowCy_probes[m,])
data_by_history[,colNum] = as.numeric(data_by_history[,colNum])
modAOV   <- aov(lm(data_by_history[,colNum]~pCO2_exposure, data = data_by_history))
shapTEST <- shapiro.test(resid(modAOV))
levTEST  <- leveneTest(modAOV)
# within continuous data.. run either ANOVA or Kruskal Wallis based on normality testing..
if(shapTEST$p.value> 0.05 & levTEST$`Pr(>F)`[1] > 0.05) { # if normal - run anova
modSUMMARY     <- summary(modAOV) # create anova table summary
modSUMMARYDF   <- signif(modSUMMARY[[1]][["Df"]][1], 2) # cal p value for anova table - 2 sig figs
modSUMMARYFval <- signif(modSUMMARY[[1]][["F value"]][1], 4) # cal p value for anova table - 2 sig figs
modSUMMARYchi  <- NA
modSUMMARYPval <- signif(modSUMMARY[[1]][["Pr(>F)"]][1], 4) # cal p value for anova table - 2 sig figs
testRun        <- "One-way ANOVA"
} else { # if non-normal (either shapiro OR levenes defied) - run the Kruskal Wallis
modSUMMARY     <- kruskal.test(data_by_history[,colNum] ~ pCO2_exposure, data = data_by_history)
modSUMMARYDF   <- signif(modSUMMARY[[2]], 2) # cal p value for Kruskal wallis test table - 2 sig figs
modSUMMARYFval <- NA
modSUMMARYchi  <- signif(modSUMMARY[[1]], 4) # cal p value for Kruskal wallis test table - 2 sig figs
modSUMMARYPval <- signif(modSUMMARY[[3]], 4) # cal p value for Kruskal wallis test table - 2 sig figs
testRun        <- "Kruskal Wallis"
} # end of if loop WITHIN the 'else' for probe type-specif testing
} # close the if else loop for probe type-specific testing (we are still in the the 'm' for loop!)
stats.table$Date          <- data_by_history$Date[1]
stats.table$pCO2_history  <- pCO2history_treatments[i,]
stats.table$FlowCyProbe   <- FlowCy_probes[m,]
stats.table$Test          <- testRun
if (shapTEST[1] == 'NA') {
stats.table$Shapiro = 'NA'} else {stats.table$Shapiro <- shapTEST$p.value}
if (levTEST[1,1] == 'NA') {
stats.table$Levenes = 'NA'} else {stats.table$Levenes <- levTEST$`Pr(>F)`[1]}
stats.table$DF            <- modSUMMARYDF
stats.table$Fvalue        <- modSUMMARYFval
stats.table$chisquared    <- modSUMMARYchi
stats.table$Pvalue        <- modSUMMARYPval
df       <- data.frame(stats.table) # name dataframe for this single row
df_total <- rbind(df_total,df) #bind to a cumulative list dataframe
print(df_total) # print to monitor progress
} # close 'm' for loop - through each flow cy probe
} # close 'i' for loop - through each pCO2 history (low, moderate, severe)
} # close 'd' for loop - through each sampling data (5/2/2023 and 5/16/2023)
df_total
df_total %>% dplyr::filter(Pvalue > 0.1)
df_total %>% dplyr::filter(!Pvalue > 0.1)
df_total %>% dplyr::filter(!Pvalue > 0.1) %>% dplyr::sort()
df_total %>% dplyr::filter(!Pvalue > 0.1) %>% sort(desc())
df_total %>% dplyr::filter(!Pvalue > 0.1) %>% sort(desc(Pvalue))
df_total %>% dplyr::filter(!Pvalue > 0.1) %>% sort(Pvalue)
df_total %>% dplyr::filter(!Pvalue > 0.1)
low <- data_filt %>%
dplyr::filter(Date %in% 20230516) %>%
dplyr::filter(pCO2_history %in% 'moderate')
summary(aov(lm(SYBR_PI_prop_dead_ADJ~pCO2_exposure, data = low)))
low <- data_filt %>%
dplyr::filter(Date %in% 20230516) %>%
dplyr::filter(pCO2_history %in% 'low')
modBetaReg     <- betareg(SYBR_PI_prop_dead_ADJ~pCO2_exposure, data = low) # beta reg model suitable for prop data
joint_tests(modBetaReg) # use 'emmeans' pavkage for an anova-like table
summary(modBetaReg)
lrtest(modBetaReg)
summary(modBetaReg)
Anova(modBetaReg)
# live cells proportion
Day1_PropLive_betareg <- betareg(SYBR_PI_prop_alive_ADJ ~ pCO2_history*pCO2_exposure, data=Day1_datafilt)
lrtest(Day1_PropLive_betareg) #  using lrtests from the 'lmtests' package
joint_tests(Day1_PropLive_betareg) # using joint_tests from 'emmeans' package
# model term                 df1 df2 F.ratio p.value
#  pCO2_history                 2 Inf   1.354  0.2582
#  pCO2_exposure                2 Inf   0.680  0.5066
#  pCO2_history:pCO2_exposure   4 Inf   2.198  0.0665
Anova(Day1_PropLive_betareg) # using Anova fro 'car' package
# Response: SYBR_PI_prop_alive_ADJ
#                            Df  Chisq Pr(>Chisq)
# pCO2_history                2 2.3096    0.31511
# pCO2_exposure               2 1.3562    0.50757
# pCO2_history:pCO2_exposure  4 8.0755    0.08885 .
TukeyHSD(Day1_PropLive_betareg)
# Response: SYBR_PI_prop_alive_ADJ
#                            Df  Chisq Pr(>Chisq)
# pCO2_history                2 2.3096    0.31511
# pCO2_exposure               2 1.3562    0.50757
# pCO2_history:pCO2_exposure  4 8.0755    0.08885 .
TukeyHSD(Day1_PropLive_betareg)
# Response: SYBR_PI_prop_alive_ADJ
#                            Df  Chisq Pr(>Chisq)
# pCO2_history                2 2.3096    0.31511
# pCO2_exposure               2 1.3562    0.50757
# pCO2_history:pCO2_exposure  4 8.0755    0.08885 .
TukeyHSD(Anova(Day1_PropLive_betareg))
TukeyHSD(Day1_PropLive_betareg)
Day1_PropLive_betareg
coef(Day1_PropLive_betareg)
lrtest(Day1_PropLive_betareg) #  using lrtests from the 'lmtests' package
linearHypothesis(Day1_PropLive_betareg)
lrtest(Day1_PropLive_betareg) #  using lrtests from the 'lmtests' package
joint_tests(Day1_PropLive_betareg) # using joint_tests from 'emmeans' package
linearHypothesis(Day1_PropLive_betareg, "(phi)_pCO2_history")
library(multcomp)
glht(Day1_PropLive_betareg)
summary(glht(Day1_PropLive_betareg))
summary(emmeans(Day1_PropLive_betareg), pairwise ~ pCO2_history:pCO2_exposure)
Day1_PropLive_betareg
summary(emmeans(Day1_PropLive_betareg), pairwise ~ pCO2_history|pCO2_exposure)
summary(emmeans(Day1_PropLive_betareg), pairwise ~ pCO2_history)
summary(emmeans(Day1_PropLive_betareg, pairwise ~ pCO2_history|pCO2_exposure))
summary(emmeans(Day1_PropLive_betareg, pairwise ~ pCO2_history:pCO2_exposure))
summary(emmeans(Day1_PropLive_betareg, pairwise ~ pCO2_history|pCO2_exposure))
# dead cells proportion - notice results are the exact same becasue values are dependent on one another (i..e 75% for A_alive is 25% for A_dead)
Day1_PropDead_betareg <- betareg(SYBR_PI_prop_dead_ADJ ~ pCO2_history*pCO2_exposure, data=Day1_datafilt)
lrtest(Day1_PropDead_betareg) #  using lrtests from the 'lmtests' package
joint_tests(Day1_PropDead_betareg) # using joint_tests from 'emmeans' package
# model term                 df1 df2 F.ratio p.value
#  pCO2_history                 2 Inf   1.354  0.2582
#  pCO2_exposure                2 Inf   0.680  0.5066
#  pCO2_history:pCO2_exposure   4 Inf   2.198  0.0665
summary(emmeans(Day1_PropDead_betareg, pairwise ~ pCO2_history|pCO2_exposure))
# live cells proportion
Day14_PropLive_betareg <- betareg(SYBR_PI_prop_alive_ADJ ~ pCO2_history*pCO2_exposure, data=Day14_datafilt)
lrtest(Day14_PropLive_betareg) #  using lrtests from the 'lmtests' package
joint_tests(Day14_PropLive_betareg) # using joint_tests from 'emmeans' package
# model term                 df1 df2 F.ratio p.value
# pCO2_history                 2 Inf   3.946  0.0193
# pCO2_exposure                2 Inf   2.272  0.1032
# pCO2_history:pCO2_exposure   4 Inf   1.306  0.2650
summary(emmeans(Day14_PropLive_betareg, pairwise ~ pCO2_history))
joint_tests(Day14_PropLive_betareg) # using joint_tests from 'emmeans' package
lrtest(Day14_PropLive_betareg) #  using lrtests from the 'lmtests' package
Day14_PropLive_betareg
joint_tests(Day14_PropLive_betareg) # using joint_tests from 'emmeans' package
#facet_wrap(~pCO2_history)
Day14_PropLive_RxnNorm
Day1_MitoSox_AOV <- aov(lm(MitoSoxGreen_Mean_FL1 ~ pCO2_history*pCO2_exposure, data=Day1_datafilt))
shapiro.test(resid(Day1_MitoSox_AOV)) # normal 0.7478
leveneTest(Day1_MitoSox_AOV) # 0.8854 PASS variance test
summary(Day1_MitoSox_AOV)
Day14_MitoSox_AOV <- aov(lm(MitoSoxGreen_Mean_FL1 ~ pCO2_history*pCO2_exposure, data=Day14_datafilt))
shapiro.test(resid(Day14_MitoSox_AOV)) # normal 0.3444
leveneTest(Day14_MitoSox_AOV) # 0.7981 PASS variance test
summary(Day14_MitoSox_AOV)
getwd()
# read data
data  <- read.csv(file="../Data/FlowCytometry/Hemolymph_data_raw.csv", header = TRUE) %>%
dplyr::mutate(Scallop_ID = as.character(Scallop_ID))
# filter out data points based on visual diagnositcs of flow cytometry data
# criterion being, but not limited to, uninterpretable clouds showing no biological importance
# these data were (in most cases) specific to a probe and not the whole individual across all measurements
data_filt <- data %>%
# PERCENT/PROPORTION LIVE AND DEAD CELLS
# first denote NAs for SYBR + PI = 51 and 59 and 60
dplyr::mutate(SYBR_PI_count_alive=as.numeric(sub(",", "", SYBR_PI_count_alive))) %>%
# ifelse(Scallop_ID %in% c('20', '51', '59', '56', '60', '70', '87', '89'),
#        NA, as.numeric(sub(",", "", SYBR_PI_count_alive)))) %>% # for #s insert Na, else insert oG data
dplyr::mutate(SYBR_PI_count_dead=as.numeric(sub(",", "", SYBR_PI_count_dead))) %>%
# ifelse(Scallop_ID %in% c('20', '51', '59', '56', '60', '70', '87', '89'),
#        NA, as.numeric(sub(",", "", SYBR_PI_count_dead)))) %>% # for #s insert Na, else insert oG data
# MITOCHONDRIAL SUPEROXIDE DISMUTASE
# NA for mitosox green data day 1: = #s 24 and 74
# NA for mitosox green data day 14: 50 (no events), 27 (no/minimal events), 56 (cont. likely), 87 (strange density), 90 (cut off, but okay)
dplyr::mutate(MitoSoxGreen_Mean_FL1= #as.numeric(sub(",", "", MitoSoxGreen_Mean_FL1))) %>%
ifelse(Scallop_ID %in% c('24', '74', '27','50','56','87','90'),
NA, as.numeric(sub(",", "", MitoSoxGreen_Mean_FL1))))  %>% # for #s insert Na, else insert oG data
# MITOCHONDRIAL MEMBRANE POTENTIAL DATA
# NA for JC-10 = 12,13, 51, 74
dplyr::mutate(JC10_FL1_monomer=
ifelse(Scallop_ID %in% c('12', '13', '51', '74'), NA, JC10_FL1_monomer)) %>% # for #s insert Na, else insert oG data insert oG data
dplyr::mutate(JC10_FL2_Jaggregate=
ifelse(Scallop_ID %in% c('12', '13', '51', '74'), NA, JC10_FL2_Jaggregate)) %>% # for #s insert Na, else insert oG data insert oG data
# calculate the FL2:FL1 ratio - this is our core data for this metric!
dplyr::mutate(JC10_FL2_FL1_Ratio = ( (as.numeric(sub(",", "", JC10_FL2_Jaggregate))) /
(as.numeric(sub(",", "", JC10_FL1_monomer))) ))  %>%
# ADJUSTED PERCENT DATA - CHANGE TO PROPORTION 0-1
# the current precent alive and dead is proportion to ALL events of the cytogram - including those NOT dyed by SYBR and PI
# here we do an ADJ percent calc through sum of ONLY the live and dead events for a new 100
# second, adjusted 100% for ONLY counts live and dead
dplyr::mutate(SYBR_PI_prop_alive_ADJ = (SYBR_PI_count_alive/(SYBR_PI_count_alive+SYBR_PI_count_dead))) %>%
dplyr::mutate(SYBR_PI_prop_dead_ADJ = (SYBR_PI_count_dead/(SYBR_PI_count_alive+SYBR_PI_count_dead)))
# FILTER DATA FOR THE DAY 1 AND DAY 14 DATA
Day1_datafilt  <- data_filt %>% dplyr::filter(Date %in% 20230502)
Day14_datafilt <- data_filt %>% dplyr::filter(Date %in% 20230516)
# View(data)
# View(data_filt)
Day14_MitoSox_AOV <- aov(lm(MitoSoxGreen_Mean_FL1 ~ pCO2_history*pCO2_exposure, data=Day14_datafilt))
shapiro.test(resid(Day14_MitoSox_AOV)) # normal 0.6608
leveneTest(Day14_MitoSox_AOV) # 0.2396 PASS variance test
summary(Day14_MitoSox_AOV)
#                             Df   Sum Sq Mean Sq F value   Pr(>F)
# pCO2_history                2 11409390 5704695  10.618 0.000307 ***
# pCO2_exposure               2  7558170 3779085   7.034 0.003029 **
# pCO2_history:pCO2_exposure  4  2601854  650464   1.211 0.326183
TukeyHSD(Day14_MitoSox_AOV)
# lets get them letters
mod_means_contr <- emmeans::emmeans(object = Day14_MitoSox_AOV,
pairwise ~ "pCO2_history:pCO2_exposure",
adjust = "tukey")
mod_means <- multcomp::cld(object = mod_means_contr$emmeans,
Letters = letters)
mod_means
#                             Df   Sum Sq Mean Sq F value   Pr(>F)
# pCO2_history                2 11409390 5704695  10.618 0.000307 ***
# pCO2_exposure               2  7558170 3779085   7.034 0.003029 **
# pCO2_history:pCO2_exposure  4  2601854  650464   1.211 0.326183
TukeyHSD(Day14_MitoSox_AOV)
Day1_MitoMemPot_AOV <- aov(lm(JC10_FL2_FL1_Ratio ~ pCO2_history*pCO2_exposure, data=Day1_datafilt))
shapiro.test(resid(Day1_MitoMemPot_AOV)) #  normal 0.1992
leveneTest(Day1_MitoMemPot_AOV) # 0.7438 PASS variance test
summary(Day1_MitoMemPot_AOV)
#                             Df Sum Sq Mean Sq F value Pr(>F)
# pCO2_history                2   4126  2062.8   2.841 0.0736 .
# pCO2_exposure               2    677   338.4   0.466 0.6318
# pCO2_history:pCO2_exposure  4   1404   351.1   0.484 0.7476
# Residuals                  31  22507   726.0
TukeyHSD(Day1_MitoMemPot_AOV)
Day1_MitoMemPot_SRH <- scheirerRayHare(JC10_FL2_FL1_Ratio ~ pCO2_history*pCO2_exposure, data=Day1_datafilt)
Day1_MitoMemPot_SRH
Day1_MitoMemPot_AOV <- aov(lm(JC10_FL2_FL1_Ratio ~ pCO2_history*pCO2_exposure, data=Day1_datafilt))
shapiro.test(resid(Day1_MitoMemPot_AOV)) #  normal 0.1992
leveneTest(Day1_MitoMemPot_AOV) # 0.7438 PASS variance test
Day14_MitoMemPot_AOV <- aov(lm(JC10_FL2_FL1_Ratio ~ pCO2_history*pCO2_exposure, data=Day14_datafilt))
shapiro.test(resid(Day14_MitoMemPot_AOV)) #  non-normal 0.0006415
leveneTest(Day14_MitoMemPot_AOV) # 0.6969 PASS variance test
Day14_MitoMemPot_SRH <- scheirerRayHare(JC10_FL2_FL1_Ratio ~ pCO2_history*pCO2_exposure, data=Day14_datafilt)
Day14_MitoMemPot_SRH
#                             Df Sum Sq      H  p.value
# pCO2_history                2  588.0 3.7297 0.154920
# pCO2_exposure               2  963.8 6.1131 0.047051 * significant!
# pCO2_history:pCO2_exposure  4  975.4 6.1868 0.185627
# Residuals                  34 4070.8
Day14_SRH_Dunns <- dunnTest(JC10_FL2_FL1_Ratio ~ pCO2_exposure,
data=Day14_datafilt,
method="bh")      # Adjusts p-values for multiple comparisons;
# See ?dunnTest for options
Day14_SRH_Dunns
#                             Df Sum Sq      H  p.value
# pCO2_history                2  588.0 3.7297 0.154920
# pCO2_exposure               2  963.8 6.1131 0.047051 * significant!
# pCO2_history:pCO2_exposure  4  975.4 6.1868 0.185627
# Residuals                  34 4070.8
Day14_SRH_Dunns <- dunnTest(JC10_FL2_FL1_Ratio ~ pCO2_exposure*pCO2_history,
data=Day14_datafilt,
method="bh")      # Adjusts p-values for multiple comparisons;
#                             Df Sum Sq      H  p.value
# pCO2_history                2  588.0 3.7297 0.154920
# pCO2_exposure               2  963.8 6.1131 0.047051 * significant!
# pCO2_history:pCO2_exposure  4  975.4 6.1868 0.185627
# Residuals                  34 4070.8
Day14_SRH_Dunns <- dunnTest(JC10_FL2_FL1_Ratio ~ pCO2_exposure:pCO2_history,
data=Day14_datafilt,
method="bh")      # Adjusts p-values for multiple comparisons;
# See ?dunnTest for options
Day14_SRH_Dunns
#                             Df Sum Sq      H  p.value
# pCO2_history                2  588.0 3.7297 0.154920
# pCO2_exposure               2  963.8 6.1131 0.047051 * significant!
# pCO2_history:pCO2_exposure  4  975.4 6.1868 0.185627
# Residuals                  34 4070.8
Day14_SRH_Dunns <- dunnTest(JC10_FL2_FL1_Ratio ~ pCO2_exposure:pCO2_history,
data=Day14_datafilt,
method="bh")      # Adjusts p-values for multiple comparisons;
#                             Df Sum Sq      H  p.value
# pCO2_history                2  588.0 3.7297 0.154920
# pCO2_exposure               2  963.8 6.1131 0.047051 * significant!
# pCO2_history:pCO2_exposure  4  975.4 6.1868 0.185627
# Residuals                  34 4070.8
Day14_SRH_Dunns <- dunnTest(JC10_FL2_FL1_Ratio ~ pCO2_exposure,
data=Day14_datafilt,
method="bh")      # Adjusts p-values for multiple comparisons;
# See ?dunnTest for options
Day14_SRH_Dunns
#                             Df Sum Sq      H  p.value
# pCO2_history                2  588.0 3.7297 0.154920
# pCO2_exposure               2  963.8 6.1131 0.047051 * significant!
# pCO2_history:pCO2_exposure  4  975.4 6.1868 0.185627
# Residuals                  34 4070.8
Day14_SRH_Dunns <- dunnTest(JC10_FL2_FL1_Ratio ~ pCO2_history,
data=Day14_datafilt,
method="bh")      # Adjusts p-values for multiple comparisons;
# See ?dunnTest for options
Day14_SRH_Dunns
#                             Df Sum Sq      H  p.value
# pCO2_history                2  588.0 3.7297 0.154920
# pCO2_exposure               2  963.8 6.1131 0.047051 * significant!
# pCO2_history:pCO2_exposure  4  975.4 6.1868 0.185627
# Residuals                  34 4070.8
Day14_SRH_Dunns <- dunnTest(JC10_FL2_FL1_Ratio ~ pCO2_exposure,
data=Day14_datafilt,
method="bh")      # Adjusts p-values for multiple comparisons;
# See ?dunnTest for options
Day14_SRH_Dunns
#facet_wrap(~pCO2_history)
Day14_MitoMemPot_RxnNorm
